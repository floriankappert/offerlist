<% content_for :title, @offer.offer_number.to_s + " " + @offer.title.to_s %>

<% content_for :header do %>
<h3>
  <%= link_to icon("back"), offers_path, :class => "btn btn-default" %>
  <%= link_to icon("list"), offers_path, :class => "btn btn-default" %>
  Offer 
  <%= link_to icon("edit"), edit_offer_path(@offer), :class => "btn btn-default" %>
  <div class="pull-right">
      <%= render 'offers/searchform' %>
  </div>
  <div class="pull-right">
    <% if @offer.draft %>
    <%= link_to "ACTIVATE", activate_offer_path(@offer), :class => "btn btn-danger", :style => "margin-right: 0.5em;" %>
    <% else %>
    <span class="label label-info">Activated</span>
    <% end %>
  </div>
</h3>  
<% end %>

<% if @offer_item.errors.any? %>
    <div class="panel panel-danger">
      <div class="panel-heading">
        <h3 class="panel-title"><%= pluralize(@offer_item.errors.count, "error") %> prohibited this offer from being saved:</h3>
      </div>
      <div class="panel-body">
        <ul>
        <% @offer_item.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
        </ul>
      </div>
    </div>
  <% end %>


<p id="notice"><%= notice %></p>

<div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading"><%= @offer.offer_number %> | <%= @offer.title %> | <%= link_to "download json object", polymorphic_path( @offer, :format => :json ), :target => "_blank" %> | <%= @offer.draft ? "Draft" : "Activated" %>
  </div>
    
  <table class="table">
    <tbody>
      <tr>
        <th>Company</th>
        <td><%= @offer.company %></td>
      </tr>
      <tr>
        <th>Projectname</th>
        <td><%= @offer.project_name %></td>
      </tr>
      <tr>
        <th>PreText</th>
        <td><%= @offer.text %></td>
      </tr>
    </tbody>
  </table>
  
  <% if @offer.offer_items.present? %>
  <div class="panel-heading" style="text-align: center;">Offeritems</div>
  <table class="table ">
    <thead>
      <th>Pos</th>
      <th>Title</th>
      <th>Description</th>
      <th>Net</th>
      <th>Vat</th>
      <th>Rate</th>
      <th>Gross</th>
      <th></th>
    </thead>
    <tbody  id="offer_item_tbody">
      <% @offer.offer_items.order("position  asc").each do |offer_item| %>
        <%= render offer_item %>
      <% end %>
    </tbody>
  </table>
  <% end %>
  <div class="panel-heading">
    <%= form_for [@offer, @offer_item], :remote => true, :html => { :role => "form", :class => "form-inline" } do |f| %>

      <div class="form-group">
        <%= f.label :position, :class => "sr-only"  %>
        <%= f.text_field :position, :class => "form-control", :placeholder => "Position", :style => "width: 50px;" %>
      </div>
      <div class="form-group">
        <%= f.label :title, :class => "sr-only"  %>
        <%= f.text_field :title, :class => "form-control", :placeholder => "Title", :style => "width: 515px;" %>
      </div>
      <div class="form-group">
        <%= f.label :gross, :class => "sr-only"  %>
        <%= f.text_field :gross, :class => "form-control", :placeholder => "gross", :style => "width: 75px;" %>
      </div>
      <div class="form-group">
        <%= f.label :net, :class => "sr-only"  %>
        <%= f.text_field :net, :class => "form-control", :placeholder => "net", :style => "width: 75px;" %>
      </div>
      <div class="form-group">
        <%= f.label :vat, :class => "sr-only" %>
        <%= f.text_field :vat, :class => "form-control", :placeholder => "vat", :style => "width: 75px"  %>
      </div>
      <div class="form-group">
        <%= f.label :vatrate, :class => "sr-only"  %>
        <%= f.text_field :vatrate, :class => "form-control", :placeholder => "vatrate", :style => "width: 75px;" %>
      </div>
      <div class="form-group">
        <%= f.label :description, :class => "sr-only"  %>
        <%= f.text_area :description, :class => "form-control", :placeholder => "description", :rows => "3", :style => "width: 900px;" %>
      </div>      
      <%= f.submit :class => "btn btn-default btn-success" %>
    <% end %>
  </div>
</div>
<div class="panel panel-default">
  <div class="panel-heading" style="text-align: center;">Credentials</div>
  <table class="table">
    <thead>
      <th>Offer created at</th>
      <th>Offer Date</th>
      <th>Due Date</th>
    </thead>
    <tbody>
      <tr>
        <td><%= @offer.created_at.to_formatted_s() %></td>
        <td><%= @offer.offer_date %></td>
        <td><%= @offer.offer_due_date %></td>
      </tr>
    </tbody>
  </table>
</div>